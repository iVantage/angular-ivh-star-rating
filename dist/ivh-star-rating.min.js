angular.module("ivh.starRating",[]),angular.module("ivh.starRating").directive("ivhStarRating",["ivhStarStamper","ivhStarColorUtils","ivhStarRatingSettings",function(a,b,c){"use strict";return{restrict:"AE",template:"<canvas></canvas>",replace:!0,link:function(d,e,f){var g=e[0].getContext("2d"),h=function(d){var h=c.get(),i=parseInt(f.ivhStarRatingStarPoints||h.starPoints,10),j=f.ivhStarRatingGravity||h.gravity,k=f.ivhStarRatingColorFill||h.colorFill,l=f.ivhStarRatingColurUnfill||h.colorUnfill,m=f.ivhStarRatingColorBorder||b.shade(k,-30),n=f.ivhStarRatingRadius||1/0,o=parseInt(f.ivhStarRatingCount||h.count,10);1/0!==n&&(e.attr("height",Math.ceil(2*n)+"px"),e.attr("width",Math.ceil(2*n)*o+"px"));var p=e[0].offsetWidth,q=e[0].offsetHeight;n=Math.min(n,Math.floor(q/2),Math.floor(p/(2*o)));var r=Math.floor(q/2),s=r;"down"===j?s=Math.max(r,q-n):"up"===j&&(s=Math.min(r,n));var t=0-n,u=0,v=0+n,w=0,x=g.createLinearGradient(t,u,v,w),y=Math.floor(d*o);g.strokeStyle=m;for(var z=0;o>z;z++){if(z<Math.floor(y))g.fillStyle=k;else if(z>Math.ceil(y))g.fillStyle=l;else{var A=(100*d-z*(100/o))/(100/o),B=Math.max(0,A-.01),C=Math.min(1,A+.01);x.addColorStop(0,k),B>0&&x.addColorStop(B,k),1>C&&x.addColorStop(C,l),x.addColorStop(1,l),g.fillStyle=x}a(g,n+2*n*z,s,n,i,.5)}};angular.isDefined(f.ivhStarRatingRatio)?f.$observe("ivhStarRatingRatio",h):f.$observe("ivhStarRating",h)}}}]),angular.module("ivh.starRating").service("ivhStarColorUtils",[function(){"use strict";var a={};return a.shade=function(a,b){var c=parseInt(a.slice(1),16),d=Math.round(2.55*b),e=(c>>16)+d,f=(c>>8&255)+d,g=(255&c)+d;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>f?1>f?0:f:255)+(255>g?1>g?0:g:255)).toString(16).slice(1)},a}]),angular.module("ivh.starRating").provider("ivhStarRatingSettings",[function(){"use strict";var a={count:5,gravity:"middle",starPoints:5,inset:.5,colorFill:"#FFD700",colorUnfill:"#FFFFFF"};this.setDefaults=function(b){angular.extend(a,b)};var b={};b.get=function(b){return b?a[b]:angular.copy(a)},this.$get=function(){return b}}]),angular.module("ivh.starRating").service("ivhStarStamper",[function(){"use strict";var a=function(a,b,c,d,e,f){a.save(),a.beginPath(),a.translate(b,c),a.moveTo(0,0-d);for(var g=0;e>g;g++)a.rotate(Math.PI/e),a.lineTo(0,0-d*f),a.rotate(Math.PI/e),a.lineTo(0,0-d);return a.closePath(),a.stroke(),a.fill(),a.restore(),a};return a}]);